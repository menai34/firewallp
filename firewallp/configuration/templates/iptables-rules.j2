#  Generated by firewallp
{%- if (policy.nat is defined) and (policy.nat|length > 0) %}
*nat
{%-     for k, v in policy.nat.iteritems() %}
:{{k|upper}} {{v}} [0:0]
{%-     endfor %}
{%-     if (nat is defined) and (nat|length > 0) %}
{%-         if (nat.prerouting is defined) and (nat.prerouting|length > 0) %}
{%-             for k, v in nat.prerouting.iteritems() %}
{%-                 if k != 'PREROUTING' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif%}
{%-         if (nat.postrouting is defined) and (nat.postrouting|length > 0) %}
{%-             for k, v in nat.postrouting.iteritems() %}
{%-                 if k != 'POSTROUTING' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (nat.prerouting is defined) and (nat.prerouting|length > 0) %}
{%-             if (nat.prerouting.PREROUTING is defined) and (nat.prerouting.PREROUTING|length > 0) %}
{%-                 for rule in nat.prerouting.PREROUTING %}
-A PREROUTING {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in nat.prerouting.iteritems() %}
{%-                 if k != 'PREROUTING' %}
-A PREROUTING -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             for k, v in nat.prerouting.iteritems() %}
{%-                 if k != 'PREROUTING' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (nat.postrouting is defined) and (nat.postrouting|length > 0) %}
{%-             if (nat.postrouting.POSTROUTING is defined) and (nat.postrouting.POSTROUTING|length > 0) %}
{%-                 for rule in nat.postrouting.POSTROUTING %}
-A POSTROUTING {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in nat.postrouting.iteritems() %}
{%-                 if k != 'POSTROUTING' %}
-A POSTROUTING -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-     endif %}
{%-     if nat.postrouting is defined %}
{%-         for k, v in nat.postrouting.iteritems() %}
{%-             if k != 'POSTROUTING' %}
{%-                 for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-         endfor %}
{%-     endif %}
COMMIT
{% endif %}
{%- if policy.mangle is defined %}
*mangle
{%- for k, v in policy.mangle.iteritems() %}
:{{k|upper}} {{v}} [0:0]
{%- endfor %}
{%- if mangle is defined %}
{%-     if (mangle is defined) and (mangle|length > 0) %}
{%-         if (mangle.prerouting is defined) and (mangle.prerouting|length > 0) %}
{%-             for k, v in mangle.prerouting.iteritems() %}
{%-                 if k != 'PREROUTING' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (mangle.input is defined) and (mangle.input|length > 0) %}
{%-             for k, v in mangle.input.iteritems() %}
{%-                 if k != 'INPUT' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (mangle.forward is defined) and (mangle.forward|length > 0) %}
{%-             for k, v in mangle.forward.iteritems() %}
{%-                 if k != 'FORWARD' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-          endif %}
{%-         if (mangle.output is defined) and (mangle.output|length > 0) %}
{%-             for k, v in mangle.output.iteritems() %}
{%-                 if k != 'OUTPUT' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (mangle.postrouting is defined) and (mangle.postrouting|length > 0) %}
{%-             for k, v in mangle.postrouting.iteritems() %}
{%-                 if k != 'POSTROUTING' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (mangle.prerouting is defined) and (mangle.prerouting|length > 0) %}
{%-             if (mangle.prerouting.PREROUTING is defined) and (mangle.prerouting.PREROUTING|length > 0) %}
{%-                 for rule in mangle.prerouting.PREROUTING %}
-A PREROUTING {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in mangle.prerouting.iteritems() %}
{%-                 if k != 'PREROUTING' %}
-A PREROUTING -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             if (mangle.logging is defined) and (mangle.logging|length > 0) %}
-A PREROUTING -j logging
{%-             endif %}
{%-             for k, v in mangle.prerouting.iteritems() %}
{%-                 if k != 'PREROUTING' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (mangle.input is defined) and (mangle.input|length > 0) %}
{%-             if (mangle.input.INPUT is defined) and (mangle.input.INPUT|length > 0) %}
{%-                 for rule in mangle.input.INPUT %}
-A INPUT {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in mangle.input.iteritems() %}
{%-                 if k != 'INPUT' %}
-A INPUT -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             for k, v in mangle.input.iteritems() %}
{%-                 if k != 'INPUT' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (mangle.forward is defined) and (mangle.forward|length > 0) %}
{%-             if (mangle.forward.FORWARD is defined) and (mangle.forward.FORWARD|length > 0) %}
{%-                 for rule in mangle.forward.FORWARD %}
-A FORWARD {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in mangle.forward.iteritems() %}
{%-                 if k != 'FORWARD' %}
-A FORWARD -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             if (mangle.logging is defined) and (mangle.logging|length > 0) %}
-A FORWARD -j logging
{%-             endif %}
{%-         endif %}
{%-     endif %}
{%-     if mangle.forward is defined %}
{%-         for k, v in mangle.forward.iteritems() %}
{%-                 if k != 'FORWARD' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-         endfor %}
{%-     endif %}
{%-         if (mangle.output is defined) and (mangle.output|length > 0) %}
{%-             if (mangle.output.OUTPUT is defined) and (mangle.output.OUTPUT|length > 0) %}
{%-                 for rule in mangle.output.OUTPUT %}
-A OUTPUT {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in mangle.output.iteritems() %}
{%-                 if k != 'OUTPUT' %}
-A OUTPUT -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             if (mangle.logging is defined) and (mangle.logging|length > 0) %}
-A OUTPUT -j logging
{%-             endif %}
{%-         endif %}
{%-     endif %}
{%-     if mangle.output is defined %}
{%-         for k, v in mangle.output.iteritems() %}
{%-                 if k != 'OUTPUT' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-         endfor %}
{%-     endif %}
{%-     if (mangle.logging is defined) and (mangle.logging|length > 0) %}
{%-             for k in mangle.logging %}
{{ k }}
{%-             endfor %}
{%-     endif %}
{%-         if (mangle.postrouting is defined) and (mangle.postrouting|length > 0) %}
{%-             if (mangle.postrouting.POSTROUTING is defined) and (mangle.postrouting.POSTROUTING|length > 0) %}
{%-                 for rule in mangle.postrouting.POSTROUTING %}
-A POSTROUTING {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in mangle.postrouting.iteritems() %}
{%-                 if k != 'POSTROUTING' %}
-A POSTROUTING -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             if (mangle.logging is defined) and (mangle.logging|length > 0) %}
-A POSTROUTING -j logging
{%-             endif %}
{%-             for k, v in mangle.postrouting.iteritems() %}
{%-                 if k != 'POSTROUTING' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
COMMIT
{% endif %}
{%- if policy.filter is defined %}
*filter
{%- for k, v in policy.filter.iteritems() %}
:{{k|upper}} {{v}} [0:0]
{%- endfor %}
{%- if filter is defined %}
{%-     if (filter is defined) and (filter|length > 0) %}
{%-         if (filter.input is defined) and (filter.input|length > 0) %}
{%-             for k, v in filter.input.iteritems() %}
{%-                 if k != 'INPUT' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (filter.forward is defined) and (filter.forward|length > 0) %}
{%-             for k, v in filter.forward.iteritems() %}
{%-                 if k != 'FORWARD' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (filter.output is defined) and (filter.output|length > 0) %}
{%-             for k, v in filter.output.iteritems() %}
{%-                 if k != 'OUTPUT' %}
:{{k|upper}} - [0:0]
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (filter.logging is defined) and (filter.logging|length > 0) %}
:logging - [0:0]
{%         endif %}
{%-         if (filter.input is defined) and (filter.input|length > 0) %}
{%-             if (filter.input.INPUT is defined) and (filter.input.INPUT|length > 0) %}
{%-                 for rule in filter.input.INPUT %}
-A INPUT {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in filter.input.iteritems() %}
{%-                 if k != 'INPUT' %}
-A INPUT -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             if (filter.logging is defined) and (filter.logging|length > 0) %}
-A INPUT -j logging
{%-             endif %}
{%-             for k, v in filter.input.iteritems() %}
{%-                 if k != 'INPUT' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-             endfor %}
{%-         endif %}
{%-         if (filter.forward is defined) and (filter.forward|length > 0) %}
{%-             if (filter.forward.FORWARD is defined) and (filter.forward.FORWARD|length > 0) %}
{%-                 for rule in filter.forward.FORWARD %}
-A FORWARD {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in filter.forward.iteritems() %}
{%-                 if k != 'FORWARD' %}
-A FORWARD -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             if (filter.logging is defined) and (filter.logging|length > 0) %}
-A FORWARD -j logging
{%-             endif %}
{%-         endif %}
{%-     endif %}
{%-     if filter.forward is defined %}
{%-         for k, v in filter.forward.iteritems() %}
{%-                 if k != 'FORWARD' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-         endfor %}
{%-     endif %}
{%-         if (filter.output is defined) and (filter.output|length > 0) %}
{%-             if (filter.output.OUTPUT is defined) and (filter.output.OUTPUT|length > 0) %}
{%-                 for rule in filter.output.OUTPUT %}
-A OUTPUT {{ rule }}
{%-                 endfor %}
{%-             endif %}
{%-             for k, v in filter.output.iteritems() %}
{%-                 if k != 'OUTPUT' %}
-A OUTPUT -j {{k|upper}}
{%-                 endif %}
{%-             endfor %}
{%-             if (filter.logging is defined) and (filter.logging|length > 0) %}
-A OUTPUT -j logging
{%-             endif %}
{%-         endif %}
{%-     endif %}
{%-     if filter.output is defined %}
{%-         for k, v in filter.output.iteritems() %}
{%-                 if k != 'OUTPUT' %}
{%-                     for rule in v %}
-A {{ k|upper }} {{ rule }}
{%-                     endfor %}
{%-                 endif %}
{%-         endfor %}
{%-     endif %}
{%-     if (filter.logging is defined) and (filter.logging|length > 0) %}
{%-             for k in filter.logging %}
{{ k }}
{%-             endfor %}
{%-     endif %}
COMMIT
{% endif %}
{%- if policy.raw is defined %}
*raw
{%- for k, v in policy.raw.iteritems() %}
:{{k|upper}} {{v}} [0:0]
{%- endfor %}
COMMIT
{% endif %}
{%- if policy.security is defined %}
*security
{%- for k, v in policy.security.iteritems() %}
:{{k|upper}} {{v}} [0:0]
{%- endfor %}
{%- endif %}
COMMIT
#